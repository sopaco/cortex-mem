# System Boundary Interface Documentation

This document describes the system's external invocation interfaces, including CLI commands, API endpoints, configuration parameters, and other boundary mechanisms.

## Command Line Interface (CLI)

### node publish-crates.js

**Description**: Publishes Rust crates to crates.io by reading version information and executing cargo publish commands.

**Source File**: `publish-crates.js`

**Arguments**:

- `--dry-run` (boolean): optional - Simulates the publishing process without actually uploading to crates.io. (default: `false`)
- `--crate-dir` (string): optional - Specifies the directory containing the crate to publish. Defaults to current directory. (default: `.`)

**Options**:

- `--dry-run, -d`(boolean): optional - Simulates the publishing process without actually uploading to crates.io. (default: `false`)
- `--crate-dir, -c`(string): optional - Specifies the directory containing the crate to publish. Defaults to current directory. (default: `.`)

**Usage Examples**:

```bash
node publish-crates.js --dry-run
```

```bash
node publish-crates.js --crate-dir ./crates/my-crate
```

```bash
node publish-crates.js -c ./crates/my-crate -d
```

### node update-versions.js

**Description**: Updates version numbers across multiple Rust crates in a monorepo, ensuring dependency consistency.

**Source File**: `update-versions.js`

**Arguments**:

- `--new-version` (string): required - The new version number to apply across all crates (e.g., '1.2.3').
- `--package-pattern` (string): optional - Regex pattern to match crate directories to update. Defaults to 'crates/*'. (default: `crates/*`)
- `--skip-git` (boolean): optional - Skips committing version changes to Git. (default: `false`)

**Options**:

- `--new-version, -v`(string): required - The new version number to apply across all crates (e.g., '1.2.3').
- `--package-pattern, -p`(string): optional - Regex pattern to match crate directories to update. Defaults to 'crates/*'. (default: `crates/*`)
- `--skip-git, -s`(boolean): optional - Skips committing version changes to Git. (default: `false`)

**Usage Examples**:

```bash
node update-versions.js --new-version 1.2.3
```

```bash
node update-versions.js -v 2.0.0 -p "crates/my-*"
```

```bash
node update-versions.js --new-version 1.1.1 --skip-git
```

## Integration Suggestions

### CI/CD Pipeline Integration

Integrate these scripts into CI/CD workflows to automate releases on tag pushes or merges.

**Example Code**:

```
# GitHub Actions example
name: Publish Crates
on:
  push:
    tags:
      - 'v*'
jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm install
      - run: node update-versions.js --new-version ${GITHUB_REF#refs/tags/v}
      - run: node publish-crates.js --crate-dir ./crates/my-crate
```

**Best Practices**:

- Use environment variables for API tokens (e.g., CRATES_IO_TOKEN)
- Validate version format before updating
- Run --dry-run in test pipelines
- Ensure Git credentials are configured in CI

### Shell Script Wrapper

Create shell wrappers to simplify and standardize release commands for team members.

**Example Code**:

```
#!/bin/bash
# release.sh
set -e

echo "Updating versions..."
node update-versions.js --new-version "$1" --skip-git

echo "Publishing crates..."
node publish-crates.js --crate-dir ./crates/my-crate

echo "Committing changes..."
git add .
git commit -m "Release v$1"
git tag "v$1"
git push origin main "v$1"
```

**Best Practices**:

- Make scripts executable and add to PATH
- Validate input parameters
- Log output to file for audit
- Use strict mode (set -e)

### Node.js Module Integration

Import and call these scripts programmatically from other Node.js applications for custom release orchestration.

**Example Code**:

```
const { execSync } = require('child_process');

function publishCrates(crateDir = '.') {
  execSync(`node publish-crates.js --crate-dir ${crateDir}`, { stdio: 'inherit' });
}

function updateVersions(newVersion, packagePattern = 'crates/*') {
  execSync(`node update-versions.js --new-version ${newVersion} --package-pattern ${packagePattern}`, { stdio: 'inherit' });
}

// Usage
updateVersions('1.2.3');
publishCrates('./crates/my-crate');
```

**Best Practices**:

- Handle errors with try/catch
- Avoid shell injection by sanitizing inputs
- Use spawn() instead of execSync for async control
- Validate version format with semver library


---

**Analysis Confidence**: 0.9/10
