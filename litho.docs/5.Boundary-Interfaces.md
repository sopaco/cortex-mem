# System Boundary Interface Documentation

This document describes the system's external invocation interfaces, including CLI commands, API endpoints, configuration parameters, and other boundary mechanisms.

## Command Line Interface (CLI)

### cortex-mem-cli

**Description**: Main CLI for interacting with the memory management system, providing subcommands for adding, searching, listing, and deleting memories, as well as optimization operations.

**Source File**: `cortex-mem-cli/src/main.rs`

**Arguments**:

- `config` (PathBuf): optional - Path to the configuration file, defaults to config.toml (default: `config.toml`)

**Options**:

- `content, c`(String): optional - Content to store as memory
- `user_id, u`(String): optional - User ID for the memory
- `agent_id, a`(String): optional - Agent ID for the memory
- `memory_type, t`(String): optional - Memory type (conversational, procedural, factual), defaults to 'conversational' (default: `conversational`)
- `query, q`(String): optional - Search query (optional - if not provided, will use only metadata filters)
- `topics`(Vec<String>): optional - Topics filter (comma-separated)
- `keywords`(Vec<String>): optional - Keywords filter (comma-separated)
- `limit, l`(usize): optional - Maximum number of results, defaults to 10 for search and 20 for list (default: `10`)
- `id`(String): required - Memory ID to delete

**Usage Examples**:

```bash
cortex-mem-cli add -c "Meeting notes" -u user123 -t conversational
```

```bash
cortex-mem-cli search -q "project status" --topics planning,review -l 5
```

```bash
cortex-mem-cli list -u user123 -l 20
```

```bash
cortex-mem-cli delete mem_12345
```

```bash
cortex-mem-cli optimize --dry-run
```

### cortex-mem-mcp

**Description**: MCP server for Cortex Memo memory management system that serves over stdio transport.

**Source File**: `cortex-mem-mcp/src/main.rs`

**Arguments**:

- `config` (PathBuf): optional - Path to the configuration file (default: `config.toml`)
- `agent` (String): optional - Agent identifier for memory operations

**Usage Examples**:

```bash
cortex-mem-mcp --config config.toml --agent agent123
```

### cortex-mem-evaluation

**Description**: Framework for evaluating Cortex-Mem core capabilities including full evaluation, recall, effectiveness, performance, dataset generation and validation.

**Source File**: `examples/cortex-mem-evaluation/src/main.rs`

**Options**:

- `config, c`(PathBuf): optional - Configuration file path, defaults to config/evaluation_config.toml (default: `config/evaluation_config.toml`)
- `output_dir, o`(PathBuf): optional - Output directory, defaults to results (default: `results`)
- `dataset_type, t`(String): optional - Dataset type: recall, effectiveness, all, defaults to 'all' (default: `all`)
- `size, s`(usize): optional - Dataset size, defaults to 100 (default: `100`)
- `use_lab_data`(bool): optional - Whether to use laboratory data, defaults to true (default: `true`)
- `dataset_path, p`(PathBuf): required - Dataset path for validation
- `dataset_type, t`(String): required - Dataset type: recall, effectiveness

**Usage Examples**:

```bash
cortex-mem-evaluation run -c config.toml -o results
```

```bash
cortex-mem-evaluation recall -c config.toml
```

```bash
cortex-mem-evaluation generate-dataset -t all -o data -s 500
```

```bash
cortex-mem-evaluation validate-dataset -p data/test.json -t recall
```

## API Interfaces

### GET /health

**Description**: Health check endpoint to verify the service is running and dependencies are available

**Source File**: `cortex-mem-service/src/handlers.rs`

**Response Format**: {"status": "healthy", "vector_store": true, "llm_service": true, "timestamp": "2025-01-01T00:00:00Z"}

### POST /memories

**Description**: Create a new memory with content and metadata

**Source File**: `cortex-mem-service/src/handlers.rs`

**Request Format**: {"content": "string", "user_id": "string", "agent_id": "string", "role": "string", "memory_type": "string", "custom": {"key": "value"}}

**Response Format**: {"success": true, "id": "string", "message": "string"}

### GET /memories

**Description**: List memories with optional filtering by user, agent, and memory type

**Source File**: `cortex-mem-service/src/handlers.rs`

**Request Format**: ?user_id=string&agent_id=string&memory_type=string&limit=number

**Response Format**: {"total": number, "memories": [{"id": "string", "content": "string", "metadata": {}, "created_at": "datetime", "updated_at": "datetime"}]}

### POST /memories/search

**Description**: Search memories using semantic search with query and optional filters

**Source File**: `cortex-mem-service/src/handlers.rs`

**Request Format**: {"query": "string", "user_id": "string", "agent_id": "string", "memory_type": "string", "limit": "number", "similarity_threshold": "number"}

**Response Format**: {"total": number, "results": [{"memory": {}, "score": "number"}]}

### GET /memories/{id}

**Description**: Get a specific memory by ID

**Source File**: `cortex-mem-service/src/handlers.rs`

**Response Format**: {"id": "string", "content": "string", "metadata": {}, "created_at": "datetime", "updated_at": "datetime"}

### PUT /memories/{id}

**Description**: Update the content of an existing memory

**Source File**: `cortex-mem-service/src/handlers.rs`

**Request Format**: {"content": "string"}

**Response Format**: {"success": true, "message": "string"}

### DELETE /memories/{id}

**Description**: Delete a memory by ID

**Source File**: `cortex-mem-service/src/handlers.rs`

**Response Format**: {"success": true, "message": "string"}

### POST /memories/batch/delete

**Description**: Batch delete multiple memories by their IDs

**Source File**: `cortex-mem-service/src/handlers.rs`

**Request Format**: {"ids": ["string", "string"]}

**Response Format**: {"success": true, "message": "string", "failed": ["string"]}

### POST /memories/batch/update

**Description**: Batch update multiple memories with new content

**Source File**: `cortex-mem-service/src/handlers.rs`

**Request Format**: {"updates": [{"id": "string", "content": "string"}, ...]}

**Response Format**: {"success_count": number, "failure_count": number, "errors": ["string"]}

### GET /api/memories

**Description**: Retrieve a list of memories with optional filtering parameters

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Request Format**: ?user_id=string&agent_id=string&run_id=string&actor_id=string&memory_type=string&limit=number

**Response Format**: {"total": number, "memories": [...]} or error response

### POST /api/memories/search

**Description**: Perform semantic search on memories using a query string and optional filters

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Request Format**: {"query": "string", "user_id": "string", "agent_id": "string", "run_id": "string", "actor_id": "string", "memory_type": "string", "limit": "number", "similarity_threshold": "number"}

**Response Format**: {"total": number, "results": [...]} or error response

### GET /api/memories/{id}

**Description**: Retrieve a single memory record by its unique identifier

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Response Format**: MemoryResponse object or null if not found

### POST /api/memories

**Description**: Create a new memory record with content and associated metadata

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Request Format**: {"content": "string", "user_id": "string", "agent_id": "string", "run_id": "string", "actor_id": "string", "role": "string", "memory_type": "string", "custom": {}}

**Response Format**: {"success": boolean, "id": "string", "message": "string"} or error response

### PUT /api/memories/{id}

**Description**: Update the content of an existing memory record

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Request Format**: {"content": "string"}

**Response Format**: {"success": boolean, "message": "string"} or error response

### DELETE /api/memories/{id}

**Description**: Delete a memory record by its unique identifier

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Response Format**: {"success": boolean, "message": "string"} or error response

### POST /api/memories/batch/delete

**Description**: Perform batch deletion of multiple memory records by their IDs

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Request Format**: {"ids": ["string", "string"]}

**Response Format**: {"success": boolean, "message": "string", "failed": ["string"]} or error response

### GET /api/memories/stats/summary

**Description**: Get statistical summary of memory data including total count, type distribution, and recent activity

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Response Format**: {"total": number, "types": {}, "users": number, "user_distribution": {}, "recent_count": number} or error response

### GET /api/memories/stats/types

**Description**: Get detailed type distribution statistics for all memories

**Source File**: `cortex-mem-insights/src/server/api/memory.ts`

**Response Format**: {"distribution": {}, "total": number} or error response

### POST /api/optimization

**Description**: Start a new memory optimization job with specified parameters

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Request Format**: {"memory_type": "string", "user_id": "string", "agent_id": "string", "run_id": "string", "actor_id": "string", "similarity_threshold": "number", "dry_run": "boolean", "verbose": "boolean"}

**Response Format**: {"success": true, "data": {"job_id": "string", "message": "string", "status": "pending", "start_time": "datetime"}, "timestamp": "datetime"} or error response

### GET /api/optimization/{jobId}

**Description**: Get the current status of a specific optimization job

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Response Format**: {"success": true, "data": OptimizationProgress, "timestamp": "datetime"} or error response with JOB_NOT_FOUND code

### POST /api/optimization/{jobId}/cancel

**Description**: Cancel a running optimization job

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Response Format**: {"success": true, "data": {"job_id": "string", "message": "string", "status": "cancelled", "cancelled_at": "datetime"}, "timestamp": "datetime"} or error response with JOB_NOT_FOUND or JOB_COMPLETED codes

### GET /api/optimization/history

**Description**: Get paginated history of optimization jobs with optional filtering

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Request Format**: ?limit=number&offset=number&status=string&start_date=datetime&end_date=datetime

**Response Format**: {"success": true, "data": {"total": number, "history": [...], "pagination": {...}}, "timestamp": "datetime"} or error response

### POST /api/optimization/analyze

**Description**: Analyze optimization opportunities without making changes (dry run)

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Request Format**: {"memory_type": "string", "user_id": "string", "agent_id": "string", "run_id": "string", "actor_id": "string", "similarity_threshold": "number"}

**Response Format**: {"success": true, "data": AnalysisResult, "timestamp": "datetime"} or error response

### GET /api/optimization/statistics

**Description**: Get aggregated statistics about optimization jobs

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Response Format**: {"success": true, "data": Statistics, "timestamp": "datetime"} or error response

### POST /api/optimization/cleanup

**Description**: Clean up old optimization history records

**Source File**: `cortex-mem-insights/src/server/api/optimization.ts`

**Request Format**: {"max_age_days": "number"}

**Response Format**: {"success": true, "data": {"deleted": "number", "remaining": "number", "message": "string"}, "timestamp": "datetime"} or error response

### GET /api/system/status

**Description**: Get overall system health status including vector store and LLM service connectivity

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Response Format**: {"success": true, "data": {"status": "healthy|unhealthy", "vector_store": "boolean", "llm_service": "boolean", "timestamp": "datetime"}, "timestamp": "datetime"} or error response

### GET /api/system/metrics

**Description**: Get real-time performance metrics including CPU, memory, and request statistics

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Response Format**: {"success": true, "data": {"cpu_usage": "number", "memory_usage": "number", "disk_usage": "number", "active_connections": "number", "request_count": "number", "error_rate": "number", "response_time_avg": "number", "timestamp": "datetime"}, "timestamp": "datetime"} or error response

### GET /api/system/info

**Description**: Get detailed system information including version, uptime, and hardware specifications

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Response Format**: {"success": true, "data": {"version": "string", "uptime": "string", "platform": "string", "arch": "string", "node_version": "string", "memory_total": "number", "memory_used": "number", "cpu_count": "number", "hostname": "string"}, "timestamp": "datetime"} or error response

### GET /api/system/logs

**Description**: Get filtered system log entries with optional level, source, and limit parameters

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Request Format**: ?limit=number&level=info|warn|error|debug&source=string

**Response Format**: {"success": true, "data": LogEntry[], "total": "number", "timestamp": "datetime"} or error response

### GET /api/system/resources

**Description**: Get detailed resource utilization including memory, CPU, disk, and network usage

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Response Format**: {"success": true, "data": {"memory": {"total": "number", "used": "number", "free": "number", "percentage": "number"}, "cpu": {"usage": "number", "cores": "number"}, "disk": {"usage": "number"}, "network": {"active_connections": "number"}}, "timestamp": "datetime"} or error response

### POST /api/system/clear-cache

**Description**: Clear system cache to free up memory and improve performance

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Response Format**: {"success": true, "message": "System cache cleared successfully", "timestamp": "datetime"} or error response

### POST /api/system/restart

**Description**: Restart the service to apply configuration changes or recover from issues

**Source File**: `cortex-mem-insights/src/server/api/system.ts`

**Response Format**: {"success": true, "message": "Service restart initiated", "timestamp": "datetime", "restart_time": "datetime"} or error response

### GET /health

**Description**: Simple health check endpoint to verify API server is running

**Source File**: `cortex-mem-insights/src/server/index.ts`

**Response Format**: {"status": "healthy", "timestamp": "datetime", "service": "cortex-mem-insights-api"}

## Router Routes

### /

**Description**: Dashboard page showing system overview and key metrics

**Source File**: `cortex-mem-insights/src/routes/+page.svelte`

### /memories

**Description**: Memories browser page for viewing and managing stored memories

**Source File**: `cortex-mem-insights/src/routes/memories/+page.svelte`

### /analytics

**Description**: Analytics page for visualizing memory usage patterns and statistics

**Source File**: `cortex-mem-insights/src/routes/analytics/+page.svelte`

### /optimization

**Description**: Optimization panel for managing memory optimization jobs

**Source File**: `cortex-mem-insights/src/routes/optimization/+page.svelte`

### /monitor

**Description**: System monitor page for viewing real-time system metrics and logs

**Source File**: `cortex-mem-insights/src/routes/monitor/+page.svelte`

## Integration Suggestions

### CLI Integration

Integrate cortex-mem-cli into automated workflows and scripts for memory management tasks.

**Example Code**:

```
#!/bin/bash
# Example script to back up memories
cortex-mem-cli list -u $USER_ID --limit 100 > backup_memories.json

cat backup_memories.json | jq -r '.memories[] | .id' | while read id; do
  cortex-mem-cli get $id > "memory_$id.json"
done
```

**Best Practices**:

- Use configuration files for consistent settings across environments
- Implement error handling around CLI commands
- Use appropriate limits to prevent excessive resource usage
- Log command output for audit purposes

### API Integration

Connect external applications to the Cortex Memory Service via HTTP API for comprehensive memory management.

**Example Code**:

```
import axios from 'axios';

// Configure API client
const api = axios.create({
  baseURL: 'http://localhost:3000',
  timeout: 10000,
});

// Create a new memory
async function createMemory(content, metadata) {
  try {
    const response = await api.post('/memories', {
      content,
      ...metadata
    });
    return response.data;
  } catch (error) {
    console.error('Failed to create memory:', error);
    throw error;
  }
}

// Search memories
async function searchMemories(query, filters) {
  try {
    const response = await api.post('/memories/search', {
      query,
      ...filters
    });
    return response.data;
  } catch (error) {
    console.error('Search failed:', error);
    throw error;
  }
}
```

**Best Practices**:

- Always handle errors gracefully with proper try-catch blocks
- Implement retry logic for transient failures
- Use environment variables for API endpoints
- Validate request data before sending
- Monitor API usage and performance

### Web Dashboard Integration

Embed the Cortex Memory Insights dashboard in other applications or customize it for specific use cases.

**Example Code**:

```
// Using iframe to embed dashboard
<iframe 
  src="http://localhost:3001" 
  width="100%" 
  height="800px" 
  title="Cortex Memory Insights"
/>

// Or use the API client directly
import { memoryApi, systemApi } from './lib/api/client';

// Fetch data for custom dashboard
async function loadDashboardData() {
  const [memories, stats, systemStatus] = await Promise.all([
    memoryApi.list(),
    memoryApi.statistics(),
    systemApi.status()
  ]);
  
  return { memories, stats, systemStatus };
}
```

**Best Practices**:

- Secure access to the dashboard with authentication
- Configure CORS appropriately for cross-origin access
- Use HTTPS in production deployments
- Monitor dashboard performance under load
- Regularly update to latest version for security fixes


---

**Analysis Confidence**: 9.5/10
