# 系统边界接口文档

本文档描述了系统的外部调用接口，包括CLI命令、API端点、配置参数等边界机制。

## 命令行接口 (CLI)

### memo-service

**描述**: Rust Agent Memory System HTTP Service

**源文件**: `memo-service/src/main.rs`

**参数**:

- `config` (PathBuf): 可选 - Path to the configuration file (默认: `config.toml`)

**使用示例**:

```bash
memo-service
```

```bash
memo-service --config /path/to/config.toml
```

### memo

**描述**: Rust Agent Memory System CLI

**源文件**: `memo-cli/src/main.rs`

**选项**:

- `content, c`(String): 必需 - Content to store as memory
- `user_id, u`(String): 可选 - User ID for the memory
- `agent_id, a`(String): 可选 - Agent ID for the memory
- `memory_type, t`(String): 可选 - Memory type (conversational, procedural, factual) (默认: `conversational`)
- `query, q`(String): 可选 - Search query (optional - if not provided, will use only metadata filters)
- `topics`(Vec<String>): 可选 - Topics filter (comma-separated)
- `keywords`(Vec<String>): 可选 - Keywords filter (comma-separated)
- `limit, l`(usize): 可选 - Maximum number of results (默认: `10`)

**使用示例**:

```bash
memo add --content "今天天气很好" --user_id "user123" --memory_type conversational
```

```bash
memo search --query "天气" --user_id "user123" --limit 5
```

```bash
memo list --user_id "user123" --memory_type factual
```

```bash
memo delete 123e4567-e89b-12d3-a456-426614174000
```

### multi-round-interactive

**描述**: Multi-round interactive conversation with a memory-enabled agent

**源文件**: `examples/multi-round-interactive/src/main.rs`

**参数**:

- `config` (PathBuf): 可选 - Path to the configuration file (默认: `config.toml`)

**使用示例**:

```bash
multi-round-interactive
```

```bash
multi-round-interactive --config ./configs/interactive-config.toml
```

## API接口

### GET /health

**描述**: 健康检查端点，返回服务及依赖组件的健康状态

**源文件**: `memo-service/src/main.rs`

### POST /memories

**描述**: 创建新记忆条目，支持对话和程序性记忆类型

**源文件**: `memo-service/src/main.rs`

### GET /memories

**描述**: 根据过滤条件列出记忆条目

**源文件**: `memo-service/src/main.rs`

### POST /memories/search

**描述**: 根据查询内容和过滤条件搜索相似的记忆

**源文件**: `memo-service/src/main.rs`

### GET /memories/:id

**描述**: 根据ID获取单个记忆条目

**源文件**: `memo-service/src/main.rs`

### PUT /memories/:id

**描述**: 更新现有记忆的内容

**源文件**: `memo-service/src/handlers.rs`

### DELETE /memories/:id

**描述**: 删除指定ID的记忆

**源文件**: `memo-service/src/handlers.rs`

## Router路由

### /health

**描述**: 健康检查路由，检查服务及依赖组件的健康状态

**源文件**: `memo-service/src/main.rs`

### /memories

**描述**: 记忆管理路由，支持创建和列出记忆

**源文件**: `memo-service/src/main.rs`

### /memories/search

**描述**: 记忆搜索路由，根据查询内容和过滤条件搜索相似的记忆

**源文件**: `memo-service/src/main.rs`

### /memories/:id

**描述**: 获取、更新或删除单个记忆的路由

**源文件**: `memo-service/src/main.rs`

**参数**:

- `id` (String): 记忆条目的唯一标识符
## 集成建议

### HTTP API

通过HTTP API与memo-service进行集成，实现记忆的创建、搜索和管理

**示例代码**:

```
curl -X POST http://localhost:3000/memories \
  -H "Content-Type: application/json" \
  -d '{"content": "今天和朋友去了公园", "user_id": "user123", "memory_type": "conversational"}'
```

**最佳实践**:

- 使用JSON格式的请求体传递参数
- 处理可能的400/404/500等HTTP错误状态码
- 在生产环境中配置适当的认证机制
- 使用连接池管理HTTP客户端

### CLI

通过命令行工具与系统交互，适合脚本化操作和自动化任务

**示例代码**:

```
memo add --content "学习了新的编程技巧" --user_id "dev001" --memory_type factual
memo search --query "编程" --user_id "dev001" --limit 3
```

**最佳实践**:

- 将常用命令封装为shell脚本
- 使用配置文件管理连接参数
- 在CI/CD流程中集成CLI命令
- 为自动化脚本添加错误重试机制

### Library

作为库集成到Rust应用程序中，直接调用MemoryManager进行记忆管理

**示例代码**:

```
use memo_core::{config::Config, memory::MemoryManager};
use std::sync::Arc;

// 加载配置
let config = Config::load("config.toml").unwrap();

// 创建MemoryManager
let memory_manager = create_memory_manager(&config).await.unwrap();
let memory_manager = Arc::new(memory_manager);

// 使用memory_manager进行记忆操作
let memory_id = memory_manager.store("示例内容".to_string(), metadata).await.unwrap();
```

**最佳实践**:

- 将MemoryManager封装在应用状态中共享
- 使用Arc智能指针进行线程安全共享
- 正确处理异步操作的错误
- 遵循Rust的所有权和生命周期规则


---

**分析置信度**: 9.5/10
